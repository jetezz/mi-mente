---
import Layout from './Layout.astro';
import Header from '../components/Header.astro';
import { StatusIndicator } from '../components/StatusIndicator';
import { fade, slide } from 'astro:transitions';

export interface Props {
  title: string;
  description?: string;
  showStatusIndicator?: boolean;
  fullWidth?: boolean;
  showSidebar?: boolean;
}

const { 
  title, 
  description = '', 
  showStatusIndicator = true,
  fullWidth = false,
  showSidebar = true
} = Astro.props;
---

<Layout title={title} description={description}>
  <Header showDashboardLink={true} />
  
  <main 
    class="min-h-screen py-8 px-4 sm:px-6 lg:px-8"
    transition:animate={fade({ duration: '0.3s' })}
  >
    <div class:list={[
      "mx-auto",
      fullWidth ? "max-w-7xl" : "max-w-5xl"
    ]}>
      <!-- Page Header Slot -->
      <div transition:name="page-header" transition:animate="slide">
        <slot name="header" />
      </div>

      {showSidebar ? (
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
          <!-- Main content: 3 cols -->
          <div 
            class="lg:col-span-3"
            transition:name="main-content"
          >
            <slot name="main" />
            <slot />
          </div>

          <!-- Sidebar: 1 col -->
          <aside 
            class="space-y-6 lg:sticky lg:top-24 lg:self-start"
            transition:name="sidebar"
            transition:animate={fade({ duration: '0.2s' })}
          >
            {showStatusIndicator && <StatusIndicator client:load />}
            <slot name="sidebar" />
          </aside>
        </div>
      ) : (
        <div transition:name="main-content">
          <slot name="main" />
          <slot />
        </div>
      )}
    </div>
  </main>
</Layout>

<style>
  main {
    view-transition-name: main-area;
  }
  
  aside {
    view-transition-name: sidebar-area;
  }
</style>
